!function(){var t=[],e=0,o=[];$.fn.e4eDialog=function(o){var s,n=Array.prototype.slice.call(arguments,1);return!(!0===n&&!this.length)&&(this.each((function(a,i){if(i.dialogid||(i.dialogid="dialog_"+e),(s=t[i.dialogid])&&"string"==typeof o)$.isFunction(s[o])&&(s=s[o].apply(s,n));else{if(!s&&!0===o)return!1;s||(s=new $.e4eDialog(i,o),e++)}})),s)},$.e4eDialog=function(o,s){var l="dialog_"+e;return this.element=o,"Multi-Image Block"==s.title&&(s.allowFullscreen=!0),n.call(this,s),this.id=l,o.dialogid=l,t[l]=this,a.call(this),i.call(this),$(this.element).trigger("load"),this},$.e4eDialog.closeTop=function(){var e=t[o[o.length-1]];e&&e.close()},$.e4eDialog.overlay=function(){c()},$.e4eDialog.open=function(t,e){var o=$(t).e4eDialog(e);o.box=t,o.open()},$.e4eDialog.hide=function(t){this.closeTop(),t&&t()},$.e4eDialog.close=function(t){this.closeTop(),t&&t()},$.e4eDialog.position=function(t,e){t.e4eDialog("resize",e)},$.e4eDialog.prototype={addButton:function(t){var e=this;if(!t)return!1;if("string"==typeof t){if(newBtnData=s.call(this,t),!newBtnData)return!1;t=newBtnData}"div"!==t.tagName&&"a"!==t.tagName&&(t.tagName="button");var o=$("<"+t.tagName+' data-id="'+t.id+'">');if(btnClass=e.options.className+"_button",t.className&&(btnClass+=" "+e.options.className+"_button-"+t.className),btnClass+=" "+e.options.className+"_button-"+t.id,o.attr("id",e.options.className+"-"+t.id),o.attr("type","button"),t.domId&&o.attr("id",t.domId),o.addClass(btnClass),o.html(t.label),t.fn&&"function"!=typeof t.fn){var n,a=[];n=new RegExp(/(^[_A-Z]+)\((.*)\)/gi).exec(t.fn),t.fn=n[1],n=n[2].split(",");for(var i=0;i<=n.length-1;i++){var l=n[i].trim().replace(/"/g,"");l&&a.push(l)}t.params=a}return t.button=o,this.buttons[t.id]=t,t},attachBtnEvents:function(){var t=this;for(key in this.buttons)$(this.buttons[key].button).on("click",(function(e){e.preventDefault();var o=t.buttons[$(this).data("id").replace(t.options.className+"-","")];o.fn&&(o.params?window[o.fn].apply(this,o.params):o.fn===t.close?o.fn.call(t,!1):o.fn.call(t,e))}))},attachBtnEvent:function(){var t,e=this;for(key in this.buttons)$(this.buttons[key].button).on("click",(function(o){o.preventDefault();var s=e.buttons[$(this).data("id").replace(e.options.className+"-","")];t=$("#eventSelect").val(),s.fn&&(s.params?(t&&(s.params.id=t),window[s.fn].apply(this,s.params)):s.fn===e.close?s.fn.call(e,!1):s.fn.call(e,o))}))},open:function(){$(this.element).trigger("beforeOpen");var e=this,s=e.options;if(!o[e.id]){if($.e4eDropdown&&$.e4eDropdown.closeAll(),$.e4eContextMenu&&$.e4eContextMenu.close(),o.length>0&&s.additional)$("."+e.options.className+"_box:last").addClass(e.options.className+"_box-slideback"),$("."+e.options.className+"_box:last").hasClass(e.options.className+"_box-ckeditor")&&e.box.addClass(e.options.className+"_box-ckeditor");else if(o.length>0){for(var n=0;n<o.length;n++)t[o[n]].close(!0);return setTimeout((function(){e.open()}),300),!1}s.overlay&&(e.dialogOverlay=c.call(this)),s.autoFullscreen&&this.fullscreen(),e.footer.removeClass(e.options.className+"_buttons-loaded"),l.call(this,(function(){e.footer.addClass(e.options.className+"_buttons-loaded")})),e.box.appendTo(e.options.appendTo),$(document).off("keydown").on("keydown",(function(t){27===t.keyCode&&$.e4eDialog.closeTop()})),e.resize(),$(this.element).trigger("open"),setTimeout((function(){e.dialogOverlay&&e.dialogOverlay.addClass(e.options.className+"_overlay-fadein"),$("#cke_dialog_uiElement_component_events-txtSource").length?e.attachBtnEvents():e.attachBtnEvent(),o.push(e.id),e.box.addClass(e.options.className+"_box-slidein").removeClass(e.options.className+"_box-slideback"),$(e.element).trigger("afterOpen")}),300)}},load:function(){},fullscreen:function(){this.box.toggleClass(this.options.className+"_box-fullscreen")},close:function(e){var s,n=this,a=o.indexOf(n.id);a>-1&&(o.splice(a,1),s=t[o[o.length-1]]),s&&s.box.addClass(n.options.className+"_box-slidein").removeClass(n.options.className+"_box-slideback"),n.dialogOverlay&&0===o.length&&!e&&n.dialogOverlay.removeClass(n.options.className+"_overlay-fadein"),n.box.removeClass(n.options.className+"_box-fullscreen "+n.options.className+"_box-slidein"),setTimeout((function(){$(n.element).trigger("close"),"load"===n.options.trigger&&delete t[n.element.dialogid],0!==o.length||e?n.box.remove():$(n.options.appendTo).empty()}),300)},resize:function(t){var e=this,o=e.options,s=o.width,n=o.height,a=0,i=0,l=.9*($(window).height()-o.offsetTop);e.box.currentDimensions&&"object"==typeof e.box.currentDimensions&&(e.box.currentDimensions.width&&(s=e.box.currentDimensions.width),e.box.currentDimensions.height&&(n=e.box.currentDimensions.height)),t&&"object"==typeof t&&(t.width&&(s=t.width),t.height&&(n=t.height)),l<n&&(n=l),s<235&&(s=235),e.box.width(s),e.box.height(n),e.box.css({top:"calc(50% + ("+o.offsetTop+"px / 2))"}),e.box.currentDimensions={width:s,height:n},e.title&&(a=e.title.outerHeight()),e.footer.hasClass(e.options.className+"_buttons-hasButtons")&&(i=e.footer.outerHeight()),e.content.css({"margin-top":a,"margin-bottom":i})}};var s=function(t){var e={ok:{id:"ok",label:"Ok",fn:this.close,className:"primary"},cancel:{id:"cancel",label:"Cancel",fn:this.close},close:{id:"close",label:"Close",fn:this.close}};return e[t.toLowerCase()]?e[t.toLowerCase()]:{id:t,label:t.charAt(0).toUpperCase()+t.substring(1).toLowerCase()}},n=function(t){var e,o,s,n=this.element,a=[];if((t=$.extend({},{title:"Dialog",className:"admin_dialog",width:960,height:550,trigger:"click",buttons:[],overlay:!0,offsetTop:115,resizeable:!1,allowFullscreen:!1,autoFullscreen:!1,contentClass:"",additional:!1,storeContent:!1,ckeditor:!1,appendTo:"#admin_dialog",overlayClick:function(){this.close()},headerClose:function(){this.close()}},t)).buttonClasses||t.buttonFunctions){for(var i=0;i<t.buttons.length;i++)e="",o="",t.buttonClasses&&(e=t.buttonClasses[i]),t.buttonFunctions&&(o=t.buttonFunctions[i]),o?a.push({id:t.buttons[i].toLowerCase(),label:t.buttons[i],fn:o,className:e}):a.push(t.buttons[i].toLowerCase());t.buttons=a}t.diagTitle&&(t.title=t.diagTitle,delete t.diagTitle),t.showClose&&(t.buttons.push("close"),delete t.showClose),t.callback&&(t.onOpen=t.callback,delete t.callback),t.topOffset&&(t.offsetTop=t.topOffset,delete t.callback),t.secondary&&(t.additional=t.secondary,delete t.secondary),t.staticLink&&(t.source=t.staticLink,delete t.staticLink),t.link&&(t.source=t.link,delete t.link),$.inArray("bind",t)&&(!1===t.bind&&(t.trigger="load"),delete t.bind),t.dialogClass=t.contentClass,$(n).data()&&$.each($(n).data(),(function(e,o){switch(e){case"dialogTitle":t.title=o;break;case"dialogClass":t.dialogClass=o,t.contentClass=o+" "+t.contentClass;break;default:t[e]=o}})),s=$(n).attr("href"),!t.source&&s&&"#"!==s&&"javascript:;"!==s&&"javascript:void(0)"!==s&&(t.source=s),this.options=t},a=function(){var t=this,e=t.options;if(t.buttons=[],t.box=$("<div>",{class:t.options.className+"_box"}),t.box.data("id",t.data),e.title&&(t.title=$("<div>",{class:t.options.className+"_title",role:"heading","aria-level":2}).html(e.title),t.box.append(t.title)),e.allowFullscreen){var o={id:"dialog_expand",fn:this.fullscreen,label:""};t.box.append(this.addButton(o).button)}var s={id:"dialog_close",label:"",fn:e.headerClose};if(t.box.append(this.addButton(s).button),t.content=$("<div>",{class:t.options.className+"_content"}),e.contentClass&&(t.box.addClass(t.options.className+"_box-"+e.dialogClass.toLowerCase()),t.content.addClass(t.options.className+"_content-"+e.contentClass)),e.ckeditor&&t.box.addClass(t.options.className+"_box-ckeditor"),t.box.append(t.content),t.footer=$("<div>",{class:t.options.className+"_buttons"}),"function"==typeof MutationObserver||"object"==typeof MutationObserver){var n=new MutationObserver((function(e){t.footer.addClass(t.options.className+"_buttons-hasButtons");for(var o=0;o<e.length;o++){var s=e[o];"childList"===s.type?(0===s.addedNodes.length&&!t.footer[0].hasChildNodes()||s.removedNodes.length>0&&!t.footer[0].hasChildNodes())&&t.footer.removeClass(t.options.className+"_buttons-hasButtons"):"attributes"===s.type&&0===t.footer.find("."+t.options.className+"_button:visible").length&&t.footer.removeClass(t.options.className+"_buttons-hasButtons")}t.resize()}));n.observe(t.footer[0],{attributes:!0,attributeFilter:["style"],subtree:!0,attributeOldValue:!0,childList:!0})}if(e.buttons.length>0)for(var a in e.buttons){var i;(i=this.addButton(e.buttons[a]))&&"object"==typeof i&&t.footer.append(i.button)}t.box.append(t.footer)},i=function(){var t=this,e=t.options;$(t.element).on("beforeOpen",(function(){t.options.onBeforeOpen&&t.options.onBeforeOpen.call(t)})),$(t.element).on("open",(function(){t.options.onOpen&&t.options.onOpen.call(t)})),$(t.element).on("afterOpen",(function(){t.options.onAfterOpen&&t.options.onAfterOpen.call(t)})),$(t.element).on("close",(function(){t.options.onClose&&t.options.onClose.call(t)})),"load"===e.trigger?t.open.call(t):"none"!==e.trigger&&$(t.element).on(e.trigger,(function(e){e.preventDefault(),e.stopPropagation(),t.open.call(t)}))},l=function(t){var e=this,o=e.options;if(o.storeContent&&""!==e.content.html())return t(),!1;switch(o.source||(o.source="/admin/dialog/dialog.error.asp"),e.content.html(""),e.content.removeClass(e.options.className+"_content-loaded"),typeof o.source){case"string":/^(?:<|#|\.)/g.test(o.source)&&$(o.source).length>0?(e.content.addClass(e.options.className+"_content-loaded"),e.content.append(o.source),t()):$.ajax({url:o.source,success:function(o){e.content.addClass(e.options.className+"_content-loaded"),e.content.html(o),t()}});break;case"object":e.content.addClass(e.options.className+"_content-loaded"),e.content.append(o.source),t()}},c=function(){var e=this,s=$("."+e.options.className+"_overlay-main");return s.length||(s=$("<div>",{class:e.options.className+"_overlay "+e.options.className+"_overlay-main"}),$(e.options.appendTo).prepend(s),s.on("click",(function(){var e=t[o[o.length-1]];void 0!==e&&e.options.overlayClick&&e.options.overlayClick.call(e)}))),s}}();